<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.maker.generator.mybatis.mapper.DatabaseMetaMapper">

	<select id="showTableStatus" parameterType="map"
		resultType="map">
		SHOW TABLE status WHERE 1 = 1
		<if
			test="mapParam.tableNameList !=null and mapParam.tableNameList !=''">
			AND NAME IN
			<foreach collection="mapParam.tableNameList" item="item"
				open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
	</select>

	<select id="querySysTableIndex" parameterType="map"
		resultType="map">
		SELECT
		T.TABLE_ID,
		T.NAME,
		T.FLAG
		FROM `information_schema`.`INNODB_SYS_TABLES` AS T
		JOIN
		`information_schema`.`INNODB_SYS_INDEXES` AS I ON T.TABLE_ID =
		I.TABLE_ID
		LEFT JOIN `information_schema`.`INNODB_SYS_FIELDS` AS F ON
		I.INDEX_ID = F.INDEX_ID
	</select>

	<select id="queryColumnMetaInformation" parameterType="map"
		resultType="map">
		SELECT
		*
		FROM `information_schema`.`TABLES` AS T
		JOIN
		`information_schema`.`COLUMNS` AS C ON T.TABLE_NAME = C.TABLE_NAME
		WHERE 1 = 1
		<if test="mapParam.tableName != null and mapParam.tableName != ''">
			AND INSTR(T.TABLE_NAME, #{mapParam.tableSchema}) <![CDATA[ > ]]>
			0
		</if>
		<if
			test="mapParam.tableSchema != null and mapParam.tableName != ''">
			AND INSTR(T.TABLE_SCHEMA, #{mapParam.tableSchema}) <![CDATA[ > ]]>
			0
		</if>
	</select>
</mapper>

